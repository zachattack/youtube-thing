<head>
  <meta http-equiv="Content-type" content="text/html; charset=utf-8">
  <title>index</title>
<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script type="text/javascript" charset="utf-8">
  google.load("jquery", "1.7.1");
  google.load("jqueryui", "1.8.16");
</script>
<script type='text/javascript' src='jsrender.js'></script>
</head>
<body>
  <div id='sidebar' style='display:inline-block;width:300px;float:left;border:1px solid black;'>
    <ul id='playlists'>
    </ul>
  </div>
  <div id='main' style='border:1px solid black;margin-left:301px;padding:10px;'>
    <h1></h1>
    <ul id='playlist'>
    </ul>
  </div>
</body>
<script id='entryTemplate' type='text/x-jquery-tmpl'>
  <li class='entry'>
    <span class='thumbnail'>
      <img src='{{=thumbnail}}' />
    </span>
    <a href='{{=href}}' class='title' target='_blank'>{{=title}}</a>
  </li>
</script>
<script type="text/javascript" charset="utf-8">
  $(function(){
    var design = "_rewrite/api/_design/by";
    var view = design + '/_view/playlist_title';
    
    $.ajax({
      url: view,
      data: {include_docs:true},
      dataType: 'json',
      success: function(response) {
        var row;
        for(var i in response.rows) {
          row = response.rows[i];
          var pl_li = $("<li>").attr('id', row.id).addClass('playlist');
          pl_li.data('doc', row.doc); // todo: do something with this
          var pl_a  = $("<a>").attr('href', '#').attr('id', row.id).text(row.key);
          $('#playlists').append(pl_li.html(pl_a));
        }
      }
    });
  });
  
  $('#playlists li').live('click', function() {
    var doc = $(this).data('doc');
    $('#main h1').text(doc.title);
    $('#playlist li').remove();
    for(var i in doc.items) {
      var video = doc.items[i].video;
      // console.log(video);
      $('#playlist').append($('#entryTemplate').render({
        title: video.title,
        thumbnail: video.thumbnail.sqDefault,
        href: video.content[5]
      }));
    }
  });
</script>