<head>
  <meta http-equiv="Content-type" content="text/html; charset=utf-8">
  <title>index</title>
<script type="text/javascript" src="https://www.google.com/jsapi"></script>
  <script type="text/javascript" charset="utf-8">
    google.load("jquery", "1.7.1");
    google.load("jqueryui", "1.8.16");
  </script>
</head>
<body>
  <div id='sidebar' style='display:inline-block;width:300px;float:left;border:1px solid black;'>
    <ul id='playlists'>
    </ul>
  </div>
  <div id='main' style='border:1px solid black;margin-left:301px;padding:10px;'>
    <h1></h1>
    <ul id='videos'>
    </ul>
  </div>
</body>
<script type="text/javascript" charset="utf-8">
  $(function(){
    var design = "_rewrite/api/_design/by"
    var view = design + '/_view/playlist_title'
    var params = {
      include_docs: true,
    };
    
    $.ajax({
      url: view,
      data: params,
      dataType: 'json',
      success: function(response) {
        var key, doc;
        for(var i in response.rows) {
          key = response.rows[i].key;
          id  = response.rows[i].id;
          doc = response.rows[i].doc;
          var pl_li = $("<li>").attr('id', id).addClass('playlist');
          pl_li.data('doc', doc); // todo: do something with this
          var pl_a  = $("<a>").attr('href', '#').attr('id', id).text(key);
          $('#playlists').append(pl_li.html(pl_a));
        }
      }
    })
  });
  
  $('#playlists li').live('click', function() {
    var doc = $(this).data('doc');
    var title, vid_li;
    $('#main h1').text(doc.title);
    $('#videos li').remove();
    for(var i in doc.items) {
      var video = doc.items[i].video;
      var link = $("<a>").attr({href: video.content[5], target: '_blank'}).text(video.title);
      $('#videos').append($("<li>").addClass('video').html(link));
    }
  });
</script>